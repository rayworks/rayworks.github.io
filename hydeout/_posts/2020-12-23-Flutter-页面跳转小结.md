---
layout: post
title: Flutter-é¡µé¢è·³è½¬å°ç»“
excerpt_separator:  <!--more-->
tags:
  - code
  - syntax highlighting
---

# The Navigation between Flutter Routes

## Navigation çºµè§ˆ

å®¹æ˜“æƒ³è±¡åˆ°çš„æ˜¯ï¼Œå®¢æˆ·ç«¯çš„å¯¼èˆªé€»è¾‘å…·æœ‰ç›¸ä¼¼æ€§ã€‚å¯¹å…·æœ‰åŸç”Ÿappç»éªŒçš„å¼€å‘è€…æ¥è¯´ï¼Œå®ƒå¯ä»¥ç±»æ¯”äº native app å¼€å‘ä¸­çš„â€œé¡µé¢â€è·³è½¬ï¼ˆAndroid ä¸­çš„ `Activity`, iOS ä¸­çš„ `ViewController`ï¼‰ã€‚åŒæ ·UIå±‚é¢çš„æ¦‚å¿µåœ¨Flutterä¹Ÿå‡ºç°äº†ï¼Œå®ƒå°±æ˜¯ `Route`å…¶å…³è”çš„æœ‰`Widget`, è¾ƒä¸ºå¸¸è§çš„Widgetæœ‰ `StatelessWidget` æˆ–æ˜¯ `StatefulWidget` ï¼›åŒæ—¶ä¸è·³è½¬é€»è¾‘ç›¸å…³çš„è¿˜æœ‰`Navigator`, è€Œ `Navigator` æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªWidget (Flutterä¸­ Widgetæ— å¤„ä¸åœ¨ï¼ğŸ˜Š)ï¼Œå®ƒéµå¾ªStackæ ˆçš„è§„åˆ™ç®¡ç†ç€ä¸€ç³»åˆ—å­Widgetã€‚

## æœ€ç›´æ¥çš„é¡µé¢è·³è½¬æ–¹å¼

ä½¿ç”¨ `MaterialPageRoute` :

```
Navigator.push(
    context,
    MaterialPageRoute(builder: (context) => YourWidget()),
  );
```

Route åˆ©ç”¨ä¸€ä¸ªbuilderæ–¹æ³•å®šä¹‰è‡ªèº«çš„Widgetï¼Œè€Œéç›´æ¥ä¼ å…¥ä¸€ä¸ªå­Widget, è¿™æ˜¯å› ä¸ºåŸºäºè‡ªèº«è¢«Pushed æˆ–æ˜¯ Poppedçš„ä¸åŒcontextç¯å¢ƒä¸‹ï¼Œå®ƒä¼šè¢«æ„å»ºä»¥åŠé‡å»ºï¼ˆbuilt and  rebuiltï¼‰ã€‚

## å…·åçš„ Route

æ‰‹æœºä¸Šçš„Appé€šå¸¸ä¼šæœ‰å¤§é‡çš„Route, è€Œé€šè¿‡åå­—å»æ‰¾åˆ°ç›¸åº”çš„Routeå¾€å¾€ä¹Ÿæ›´å®¹æ˜“ã€‚æŒ‰ç…§çº¦å®šRouteçš„åå­—å’Œè·¯å¾„çš„è¡¨ç¤º(path-like structure)æ¯”è¾ƒç›¸åƒã€‚"/" ç”¨ä»¥è¡¨ç¤º App çš„Homeé¡µé¢çš„Routeã€‚

`MaterialApp` åœ¨åˆ›å»ºçš„æ—¶å€™å¯ä»¥æŒ‡å®šå…¶ `routes` (ç»“æ„ä¸º `Map<String, WidgetBuilder>`)ï¼Œå®ƒä¿ç•™äº† Routeçš„åå­—ä¸ åˆ›å»ºå¯¹åº”Widget build æ–¹æ³•çš„æ˜ å°„å…³ç³»ã€‚

```
 MaterialApp(
   home: MyAppHome(), // becomes the route named '/'
   routes:   {
     '/a_route_name': (BuildContext context) => YourWidget(),
   },
 )
```

æŒ‰åå­—æ˜¾ç¤ºä¸€ä¸ªRoute :

```
Navigator.pushNamed(context, '/a_route_name');
```

## å‚æ•°ä¼ é€’

### è®¾ç½®ä¼ å…¥å‚æ•°

åŒæ ·ä½¿ç”¨ `MaterialPageRoute`ï¼Œå¯ä»¥è®¾ç½®å…¶å¯é€‰å‚æ•°`settings` ä¼ å…¥å‚æ•°:
```
MaterialPageRoute(
  builder: (BuildContext context) {
    return YourWidget();
  },
  settings: RouteSettings(arguments: your_param_object),
);

```

å¯¹äºå…·åçš„Routeï¼Œç±»ä¼¼çš„æ–¹æ³•æœ‰:

```
Navigator.pushNamed(context, routeName, arguments: your_param_object);
```

### è¯»å–ä¼ å…¥çš„å‚æ•°

```
class MyWidget {
  @override
  Widget build(BuildContext context) {
    final MyArgs args = ModalRoute.of(context).settings.arguments;
    // ...
  }
}
```

### è®¾ç½®ä¼ å‡ºçš„å‚æ•°

åœ¨ç¬¬2ä¸ªWidgetä¸­ (`SelectionScreen`) è®¾å®šè¿”å›å€¼

```
Navigator.pop(context, 'Yep!');
```

åœ¨é¦–ä¸ªWidgetä¸­æ¥æ”¶:

```
_navigateAndDisplaySelection(BuildContext context) async {
  final result = await Navigator.push(
    context,
    MaterialPageRoute(builder: (context) => SelectionScreen()),
  );

  // After the Selection Screen returns a result, hide any previous snackbars
  // and show the new result.
  Scaffold.of(context)
    ..removeCurrentSnackBar()
    ..showSnackBar(SnackBar(content: Text("$result")));
}

```

## æ›´å¤š Navigation ç›¸å…³çš„æ–¹æ³•

* `Navigator.popAndPushNamed(context, routeName);`
* `Navigator.of(context).pushNamedAndRemoveUntil(HomeScreen.routeName, (_) => false);`
* `Navigator.of(context).pushReplacement(newRoute)`

## å‚è€ƒå¼•ç”¨

* [Flutter Doc](https://flutter.dev/docs/cookbook#navigation)
  
* [Flutter Tutorial: Multiple Screens and How-To Navigate Them](https://blog.codemagic.io/flutter-tutorial-multiple-screens-and-how-to-navigate-them/)
